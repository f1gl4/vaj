import { useState } from 'react';
import { TextField, Button, Stack } from '@mui/material';

export default function MalwareForm({ initial = {}, onSubmit }) {
  const [form, setForm] = useState({
    name: initial.name || '',
    firstSeen: initial.firstSeen ? initial.firstSeen.slice(0,10) : '',
    description: initial.description || '',
    type: initial.type || '',
    severity: initial.severity || 1,
    referenceUrl:initial.referenceUrl || '',
  });

  const handle = e =>
    setForm({ ...form, [e.target.name]: e.target.value });

  return (
    <form
      onSubmit={e => {
        e.preventDefault();
        onSubmit({ ...form, severity: Number(form.severity) });
      }}
    >
      <Stack spacing={2} sx={{ maxWidth: 500 }}>
        <TextField label="Name" name="name" value={form.name} onChange={handle} required />
        <TextField label="First seen" name="firstSeen"  type="date"
                   value={form.firstSeen} onChange={handle} InputLabelProps={{ shrink: true }} required />
        <TextField label="Type" name="type" value={form.type} onChange={handle} required />
        <TextField label="Severity (1-10)" type="number" name="severity"
                   value={form.severity} onChange={handle} inputProps={{ min:1,max:10 }} required />
        <TextField label="Description" name="description" multiline rows={3}
                   value={form.description} onChange={handle} required />
        <TextField label="Reference URL" name="referenceUrl"
                   value={form.referenceUrl} onChange={handle}/>
        <Button type="submit" variant="contained">Save</Button>
      </Stack>
    </form>
  );
}
